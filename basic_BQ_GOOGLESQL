--select 3 columns from table

SELECT Name, Equipment,Age FROM `rajivdemobq.rajivbq.openpowerlifting` 


--select all columns 

Select * from `rajivdemobq.rajivbq.openpowerlifting`


--unique values sex amd equipment 

select distinct Equipment,Sex  from `rajivdemobq.rajivbq.openpowerlifting`


--operators and filters

select * from `rajivdemobq.rajivbq.openpowerlifting`  
where age < 30 


-- equipment =! raw
select * from `rajivdemobq.rajivbq.openpowerlifting`
where Equipment <> 'Raw'

--use multiple 

select * from `rajivdemobq.rajivbq.openpowerlifting`
where Equipment in ('Single-ply','Raw')


--or operator 

select * from `rajivdemobq.rajivbq.openpowerlifting`
where Equipment in ('Single-ply','Raw') or Division ='Master 51+'


--and operator
select * from `rajivdemobq.rajivbq.openpowerlifting`
where Equipment in ('Single-ply','Raw') and  Division ='Teen' 

--limit and subqueries

--top 10 rows
select Name,Age from `rajivdemobq.rajivbq.openpowerlifting` 
where Equipment = 'Raw'and Age is not null
order by Age 
limit 10 

--oldest person in the table

select Name,Age from `rajivdemobq.rajivbq.openpowerlifting` 
where Equipment = 'Raw'and Age is not null
order by Age desc
limit 1

--second oldest in the table
select Name,Age from `rajivdemobq.rajivbq.openpowerlifting` where Equipment ='Raw'and Name <>
    (select Name from `rajivdemobq.rajivbq.openpowerlifting` 
    where Equipment = 'Raw'and Age is not null
    order by Age desc
    limit 1)
order by age desc 
limit 1

-- distinct 10 from the list or age highest with no nulls 
select distinct Name from 
 ( select Name from `rajivdemobq.rajivbq.openpowerlifting` 
        where Equipment = 'Raw'and Age is not null
        order by Age desc
        limit 10)



--Aggregation groupby and aliases

--SIX aggregation SUM

select sum(TotalKg)
from `rajivdemobq.rajivbq.openpowerlifting` 
where Equipment ='Raw' and Age <15

--Count 
select sum(TotalKg), COUNT(Name)
from `rajivdemobq.rajivbq.openpowerlifting` 
where Equipment ='Raw' and Age <15

--avg max min 

select sum(TotalKg), count(Name), Avg(TotalKg), max(TotalKg), min(TotalKg)
from `rajivdemobq.rajivbq.openpowerlifting` 
where Equipment ='Raw' and Age <15


--count if 
select countif(age < 14)
from `rajivdemobq.rajivbq.openpowerlifting`

--countif multiple statement 
select countif(age <14 and Equipment = 'Raw')
from `rajivdemobq.rajivbq.openpowerlifting`

--groupby  and alias
select Name,Equipment, Sum(TotalKg) as TotalKg_sum
from `rajivdemobq.rajivbq.openpowerlifting`
where Equipment = 'Raw' and Age <15
Group By Name,Equipment


--like and wildcards
--starting with P

select Name from `rajivdemobq.rajivbq.openpowerlifting`
where Name like 'P%'

-- ending Y 
select Name from `rajivdemobq.rajivbq.openpowerlifting`
where Name like '%Y'

--second letter e 

select Name from `rajivdemobq.rajivbq.openpowerlifting`
where Name like '_e%'

--having clause
select Name, Sum(TotalKg) as TotalKg_sum
from `rajivdemobq.rajivbq.openpowerlifting`
--where TotalKg_sum > 500
group by Name
having TotalKg_sum > 500

